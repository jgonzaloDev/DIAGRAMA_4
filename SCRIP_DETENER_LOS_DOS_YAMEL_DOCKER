
#!/bin/bash
set -e

# Detectar si se usa 'docker compose' o 'docker-compose'
if docker compose version >/dev/null 2>&1; then
    DC="docker compose"
elif docker-compose version >/dev/null 2>&1; then
    DC="docker-compose"
else
    echo "âŒ No se encontrÃ³ Docker Compose."
    exit 1
fi

cd ~/otel-stack

echo "ğŸ›‘ Deteniendo Elastic Stack..."
$DC -f docker-compose-elastic.yaml down

echo "ğŸ›‘ Deteniendo Otel Collector..."
$DC -f docker-compose-collector.yaml down

# Eliminar contenedores huÃ©rfanos si quedaron
docker rm -f elasticsearch apm-server kibana otel-collector 2>/dev/null || true

echo "âœ… Todo detenido. Ya puedes aplicar tu nueva configuraciÃ³n."
